<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Swifty Finch"/><link rel="canonical" href="https://swiftyfinch.github.io/en/2023-04-22-rugby-remastered"/><meta name="twitter:url" content="https://swiftyfinch.github.io/en/2023-04-22-rugby-remastered"/><meta name="og:url" content="https://swiftyfinch.github.io/en/2023-04-22-rugby-remastered"/><title>🏈 Rugby: Remastered | Swifty Finch</title><meta name="twitter:title" content="🏈 Rugby: Remastered | Swifty Finch"/><meta name="og:title" content="🏈 Rugby: Remastered | Swifty Finch"/><meta name="description" content="A lot of time has passed since the release of the first version of Rugby. Last time I struggled with indexing at all costs. This time, I was fixing fundamental problems and got a little carried away. This is how 🏈 Rugby: Remastered appeared.</p>"/><meta name="twitter:description" content="A lot of time has passed since the release of the first version of Rugby. Last time I struggled with indexing at all costs. This time, I was fixing fundamental problems and got a little carried away. This is how 🏈 Rugby: Remastered appeared.</p>"/><meta name="og:description" content="A lot of time has passed since the release of the first version of Rugby. Last time I struggled with indexing at all costs. This time, I was fixing fundamental problems and got a little carried away. This is how 🏈 Rugby: Remastered appeared.</p>"/><!--Yandex.Metrika counter--><script type="text/javascript">(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

ym(62530267, "init", {
     clickmap:true,
     trackLinks:true,
     accurateTrackBounce:true
});</script><noscript><div><img src="https://mc.yandex.ru/watch/62530267" style="position:absolute; left:-9999px;" alt="" /></div></noscript><!--/Yandex.Metrika counter--><meta name="yandex-verification" content="57c929529030b8fd"/><meta name="google-site-verification" content="u8NFg-rSs0ZM826TWcHCMQ90RRHRjEk9SpRSbYcB1rQ"/><meta name="twitter:card" content="summary_large_image"/><link rel="stylesheet" href="/styles.css" type="text/css"/><link rel="stylesheet" href="/code.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180"/><link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32"/><link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16"/><link rel="manifest" href="/site.webmanifest"/><meta name="twitter:image" content="https://swiftyfinch.github.io/posts/2023-04-22-rugby-remastered/preview.png"/><meta name="og:image" content="https://swiftyfinch.github.io/posts/2023-04-22-rugby-remastered/preview.png"/></head><body class="item-page"><header><div class="wrapper"><div class="facade"><a class="site-name" href="/en"><img class="avatar" src="/site/avatar.png"/>Swifty Finch</a><div class="icons"><div><a class="icon" href="https://github.com/swiftyfinch"><img src="/site/networks/github.png"/></a></div><div><a class="icon" href="https://www.linkedin.com/in/vyacheslav-khorkov-92b65164"><img src="/site/networks/linkedin.png"/></a></div><div><a class="icon" href="https://github.com/swiftyfinch/rugby"><img src="/site/networks/rugby.png"/></a></div><div><a class="icon" href="https://github.com/swiftyfinch/xtree"><img src="/site/networks/xtree.png"/></a></div></div><nav><a href="/ru"><div>ru</div></a></nav></div></div></header><div class="wrapper"><article><div class="content"><h1><p>🏈 <strong>Rugby:</strong> Remastered</p></h1><div class="tag-list"><a href="/tags/rugby"><div style="background-color: #e86648">rugby</div></a><a href="/tags/tools"><div style="background-color: #efac32">tools</div></a><a href="/tags/swift"><div style="background-color: #6c99bb">swift</div></a></div><div class="date"><img class="date_icon" src="/reactions/calendar.svg"/><span>22.04.2023</span></div><div class="time_to_read"><img class="time_to_read_icon" src="/reactions/watch.svg"/><span class="time_to_read_text">4 min</span></div><p>A lot of time has passed since the release of the first version of Rugby. <a href="/en/2021-03-09-rugby-story/">Last time</a> I struggled with indexing at all costs. This time, I was fixing fundamental problems and got a little carried away. This is how 🏈 <a href="https://github.com/swiftyfinch/Rugby">Rugby: Remastered</a> appeared.</p><img src="/posts/2023-04-22-rugby-remastered/demo.gif"/><h2 id="for_what"><img class="reaction" src="/reactions/man_tipping_hand.png" alt="man_tipping_hand.png" title="man_tipping_hand.png"> <a href="#for_what">For What?</a></h2><p>Maybe you wonder why I needed to develop a new version. What’s wrong with the previous one? It has some <strong>fundamental drawbacks</strong> which make development pretty complicated. It is not only my opinion. I had some feedback from the community.</p><p>I realized that I needed to <strong>reinvent almost everything</strong>. And I did it all in one go. I thought it was better to make one major version instead of a bunch of them. But anyway, I tried to <strong>keep the known soul</strong> of Rugby and slightly embellish it.</p><h2 id="different"><img class="reaction" src="/reactions/loupe.png" alt="loupe.png" title="loupe.png"> <a href="#different">What Makes the New Version <strong>Different</strong>?</a></h2><h4><img class="reaction" src="/reactions/houses.png" alt="houses.png" title="houses.png"> Cache consistency</h4><p>Sometimes Rugby wasn’t rebuilding modules after changes. The issue could be solved by calling command <strong>rugby clean</strong> or passing the flag <strong>--ignore-checksums</strong>. But it was not by design and led to user’s frustration. At the same time, it used to rebuild modules too often even if it was unnecessary. I challenged myself and tried to make <strong>a new better algorithm</strong> for calculating modules checksums.</p><h4><img class="reaction" src="/reactions/spider_web.png" alt="spider_web.png" title="spider_web.png"> Cache distribution</h4><p>The previous version keeps cache in each project directory. That choice bounds Rugby development. I decided to move the projects cache to <strong>one global directory</strong>. It allows <strong>reusing all binaries</strong> between any git branch or even any project. Also, it can be used as a remote cache between different Macs, including CI runners.</p><h4><img class="reaction" src="/reactions/crystal_ball.png" alt="crystal_ball.png" title="crystal_ball.png"> W/o magic interfaces</h4><p>I received a lot of questions about Rugby commands. Some of them have bad names. Names are repeated with different results. They are unclear and have unexpected magic under the hood. I read some CLT guides and tried to <strong>make everything a bit better</strong>.</p><h4><img class="reaction" src="/reactions/rocket.gif" alt="rocket.gif" title="rocket.gif"> Optimizations</h4><p>I always do experiments in my home projects. Now I’m learning async/await API, and this fact has already changed Rugby architecture. I tried to make <strong>all things targeted to concurrency</strong>. Also, I got carried away during refactoring and reinvented some Rugby parts in favour of speed.</p><h2 id="remote_cache"><img class="reaction" src="/reactions/whale.png" alt="whale.png" title="whale.png"> <a href="#remote_cache">Remote Cache</a></h2><p>All these changes opened the way to the implementation of <a href="https://github.com/swiftyfinch/Rugby/blob/main/docs/remote-cache.md">remote cache</a>. The basic command works with AWS S3, but Rugby interfaces allow you to configure <strong>uploading and downloading for any cloud storage</strong>.</p><p>This approach can seriously <strong>reduce the total building time of the entire team</strong> both on personal Macs and when launching CI/CD pipelines. However, it is worth paying attention to optimizing the download speed from the selected cloud storage.</p><h2 id="roadmap"><img class="reaction" src="/reactions/triangular_flag.png" alt="triangular_flag.png" title="triangular_flag.png"> <a href="#roadmap">Roadmap</a></h2><p>What's next? I'm going to <strong>refactor</strong> some parts of the codebase. Then I will write more <strong>tests</strong>, including unit ones, which were absent in the first version. After that, I will prepare the <strong>documentation</strong>, set up the necessary pipelines and be ready for the release of the <strong>open-source</strong> version. <img class="reaction" src="/reactions/party.png" alt="party.png" title="party.png"></p><h2 id="roadmap"><img class="reaction" src="/reactions/finish.svg" alt="finish.svg" title="finish.svg"> <a href="#roadmap">Conclusion</a></h2><p><a href="https://github.com/swiftyfinch/Rugby">The new version of Rugby</a> 🏈 not only struggles with indexing, but can also seriously <strong>reduce the build process time</strong>. After redesigning the interface, it has become <strong>easier to use</strong>. And some of the steps in the commands have <strong>sped up</strong>.</p><p>At the same time, the source code was rewritten to a new architecture, which in my opinion, will be <strong>more understandable to everyone</strong>. I hope that soon, I will open the source code, and it will be easier for the community to <strong>develop and support Rugby together</strong>. <img class="reaction" src="/reactions/waving_hand.png" alt="waving_hand.png" title="waving_hand.png"></p></div></article></div><footer><a class="home" href="/en" title="Go Home"><img src="/reactions/home.svg"/></a><p>© 2023. All rights reserved.</p><p>Generated using <a href="https://github.com/johnsundell/publish">Publish</a></p></footer></body></html>